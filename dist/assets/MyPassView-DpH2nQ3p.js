import{r as e,o as a,k as s,l as t,j as l,m as o,x as r,q as i,I as n,Y as c,J as u,v as d,F as p,L as m,t as v}from"./vendor-C-dIp69U.js";import{_ as y,u as h}from"./index-BPtefy7M.js";import{B as f}from"./Breadcrumb-Sed0oLr7.js";import"./swiper-WOzPqNul.js";/* empty css                                                                   */const P={class:"my-pass-panel"},g={class:"container"},b={key:0,class:"login-outer"},w={class:"login-box"},$=["placeholder"],k=["placeholder"],N={class:"forgot-password"},_={class:"btn btn-primary login-btn",type:"submit"},S={key:0,class:"error"},C={class:"modal-header"},j={class:"form-group"},q=["placeholder"],U=["disabled"],I={key:1,class:"dashboard-container"},V={class:"side-menu"},T={class:"user-profile"},A={class:"user-avatar"},R={class:"user-info"},x={class:"nav-menu"},X={class:"main-content"},L={key:0,class:"content-section"},O={class:"section-header"},z={class:"section-subtitle"},J={class:"reservation-list"},E={class:"reservation-header"},M={class:"reservation-details"},B={class:"detail-row"},W={class:"detail-item"},H={class:"detail-label"},F={class:"detail-value"},D={class:"detail-item"},G={class:"detail-label"},Y={class:"detail-value"},K={class:"detail-row"},Q={class:"detail-item"},Z={class:"detail-label"},ee={class:"detail-value price"},ae={class:"detail-item"},se={class:"detail-label"},te={class:"detail-value"},le={class:"reservation-actions"},oe=["onClick"],re=["onClick","disabled"],ie={key:0,class:"empty-state"},ne={key:1,class:"content-section"},ce={class:"section-header"},ue={class:"section-subtitle"},de={class:"form-section"},pe={class:"form-row"},me={class:"form-group"},ve=["placeholder"],ye={class:"form-group"},he=["placeholder"],fe={class:"form-section"},Pe={class:"form-group"},ge=["placeholder"],be={class:"field-note"},we={class:"form-group"},$e=["placeholder"],ke={class:"form-section"},Ne={class:"form-group"},_e=["placeholder"],Se={class:"form-row"},Ce={class:"form-group"},je=["placeholder"],qe={class:"form-group"},Ue=["placeholder"],Ie={class:"form-group"},Ve=["placeholder"],Te={class:"form-actions"},Ae={class:"btn btn-primary",type:"submit"},Re={key:2,class:"content-section"},xe={class:"section-header"},Xe={class:"section-subtitle"},Le={class:"form-group"},Oe=["placeholder"],ze={class:"form-group"},Je=["placeholder"],Ee={class:"field-note"},Me={class:"form-group"},Be=["placeholder"],We={class:"form-actions"},He={class:"btn btn-primary",type:"submit"},Fe=y({__name:"MyPassView",setup(y){const{t:Fe}=h(),De=e(!1),Ge=e(""),Ye=e(""),Ke=e(""),Qe=e("reservations"),Ze=e([]),ea=e({firstName:"",lastName:"",email:"",phone:"",address:"",city:"",country:"",zip_code:""}),aa=e(""),sa=e(""),ta=e(""),la=e(""),oa=e(!1),ra=e(!1),ia=e(""),na=e(!1),ca=e(""),ua=e(!1);async function da(e){try{const a=await fetch(`https://backend.searchyourtour.com/api/customer/profile/${e}`,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest"}}),s=await a.json();if(s.status){const e=(s.data.fullname||"").split(" ");ea.value={firstName:e[0]||"",lastName:e.slice(1).join(" ")||"",email:s.data.email||"",phone:s.data.phone||"",address:s.data.address||"",city:s.data.city||"",country:s.data.country||"",zip_code:s.data.zip_code||""}}}catch(a){}}async function pa(e){try{const a=await fetch(`https://backend.searchyourtour.com/api/customer/reservations/${e}`,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest"}}),s=await a.json();s.status&&(Ze.value=s.data||[])}catch(a){}}async function ma(){try{Ke.value="";const a=await fetch("https://backend.searchyourtour.com/api/login",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({email:Ge.value,password:Ye.value})}),s=await a.json();if(s.status){De.value=!0,Ke.value="",localStorage.setItem("user",JSON.stringify(s.data)),localStorage.setItem("isLoggedIn","true");try{await da(s.data.id),await pa(s.data.id)}catch(e){}Ge.value="",Ye.value=""}else Ke.value=Fe("myPass.login.error")}catch(e){Ke.value=Fe("myPass.login.generalError")}}function va(){De.value=!1,localStorage.removeItem("user"),localStorage.removeItem("isLoggedIn")}async function ya(){try{const e=localStorage.getItem("user");if(!e)return void alert(Fe("myPass.messages.userNotFound"));const a=JSON.parse(e),s=await fetch(`https://backend.searchyourtour.com/api/customer/profile/update/${a.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({fullname:`${ea.value.firstName} ${ea.value.lastName}`.trim(),email:ea.value.email,phone:ea.value.phone,address:ea.value.address,city:ea.value.city,country:ea.value.country,zip_code:ea.value.zip_code})}),t=await s.json();t.status?alert(Fe("myPass.messages.profileUpdated")):alert(Fe("myPass.messages.profileUpdateFailed")+(t.message||Fe("myPass.messages.unknownError")))}catch(e){alert(Fe("myPass.messages.generalError"))}}async function ha(){try{if(la.value="",oa.value=!1,sa.value.length<6)return la.value=Fe("myPass.password.validation.tooShort"),void(oa.value=!1);if(sa.value!==ta.value)return la.value=Fe("myPass.password.validation.noMatch"),void(oa.value=!1);const e=localStorage.getItem("user");if(!e)return la.value=Fe("myPass.messages.userNotFound"),void(oa.value=!1);const a=JSON.parse(e),s=await fetch(`https://backend.searchyourtour.com/api/customer/change-password/${a.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({current_password:aa.value,new_password:sa.value,new_password_confirmation:ta.value})}),t=await s.json();t.status?(la.value=Fe("myPass.password.success"),oa.value=!0,aa.value="",sa.value="",ta.value=""):(la.value=t.message||Fe("myPass.password.error"),oa.value=!1)}catch(e){la.value=Fe("myPass.password.generalError"),oa.value=!1}}function fa(e){if(!e)return"N/A";return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}function Pa(e){const a=[];return e.adult>0&&a.push(`${Fe("myPass.reservations.adults")}: ${e.adult}`),e.child>0&&a.push(`${Fe("myPass.reservations.children")}: ${e.child}`),e.infant>0&&a.push(`${Fe("myPass.reservations.infants")}: ${e.infant}`),e.buggy>0&&a.push(`${Fe("myPass.reservations.buggy")}: ${e.buggy}`),a.length>0?a.join(", "):Fe("myPass.reservations.noAttendees")}function ga(e){if(!e)return!0;return["pending","waiting","approved","paid","Pending","Waiting","Approved","Paid"].includes(e)}function ba(){const e=ea.value.firstName||"",a=ea.value.lastName||"";return(e.charAt(0)+a.charAt(0)).toUpperCase()||"U"}async function wa(){try{na.value=!0,ca.value="",ua.value=!1;const e=await fetch("https://backend.searchyourtour.com/api/customer/password/email",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({email:ia.value})}),a=await e.json();a.status?(ua.value=!0,ca.value=a.message||Fe("myPass.resetPassword.success"),ia.value="",setTimeout(()=>{ra.value=!1,ca.value=""},3e3)):(ua.value=!1,ca.value=a.message||Fe("myPass.resetPassword.error"))}catch(e){ua.value=!1,ca.value=Fe("myPass.messages.generalError")}finally{na.value=!1}}return a(async()=>{const e=localStorage.getItem("isLoggedIn"),a=localStorage.getItem("user");if("true"===e&&a){De.value=!0;try{const e=JSON.parse(a);await da(e.id),await pa(e.id)}catch(s){}}}),(e,a)=>(v(),s("div",P,[t("div",g,[l(f)]),De.value?(v(),s("div",I,[t("aside",V,[t("div",T,[t("div",A,[t("span",null,r(ba()),1)]),t("div",R,[t("h3",null,r(((ea.value.firstName||"")+" "+(ea.value.lastName||"")).trim()||"User"),1),t("p",null,r(e.$t("myPass.dashboard.account")),1)])]),t("nav",x,[t("div",{class:u(["nav-item",{active:"reservations"===Qe.value}]),onClick:a[8]||(a[8]=e=>Qe.value="reservations")},[a[23]||(a[23]=t("i",{class:"nav-icon"},"ðŸ“‹",-1)),t("span",null,r(e.$t("myPass.dashboard.myReservations")),1)],2),t("div",{class:u(["nav-item",{active:"info"===Qe.value}]),onClick:a[9]||(a[9]=e=>Qe.value="info")},[a[24]||(a[24]=t("i",{class:"nav-icon"},"ðŸ‘¤",-1)),t("span",null,r(e.$t("myPass.dashboard.profile")),1)],2),t("div",{class:u(["nav-item",{active:"password"===Qe.value}]),onClick:a[10]||(a[10]=e=>Qe.value="password")},[a[25]||(a[25]=t("i",{class:"nav-icon"},"ðŸ”’",-1)),t("span",null,r(e.$t("myPass.dashboard.changePassword")),1)],2)]),t("button",{class:"logout-btn",onClick:va},[a[26]||(a[26]=t("i",{class:"logout-icon"},"ðŸšª",-1)),d(" "+r(e.$t("myPass.dashboard.logout")),1)])]),t("main",X,["reservations"===Qe.value?(v(),s("section",L,[t("div",O,[t("h2",null,r(e.$t("myPass.reservations.title")),1),t("p",z,r(e.$t("myPass.reservations.subtitle")),1)]),t("div",J,[(v(!0),s(p,null,m(Ze.value,l=>{return v(),s("div",{class:"reservation-card",key:l.id},[t("div",E,[t("h3",null,r(l.tourName),1),t("span",{class:u(["status-badge",l.payment_status])},r((o=l.payment_status,o.charAt(0).toUpperCase()+o.slice(1))),3)]),t("div",M,[t("div",B,[t("div",W,[a[27]||(a[27]=t("i",{class:"detail-icon"},"ðŸ“…",-1)),t("span",H,r(e.$t("myPass.reservations.date")),1),t("span",F,r(fa(l.tour_date)),1)]),t("div",D,[a[28]||(a[28]=t("i",{class:"detail-icon"},"â°",-1)),t("span",G,r(e.$t("myPass.reservations.time")),1),t("span",Y,r(l.tour_time||e.$t("myPass.reservations.tbd")),1)])]),t("div",K,[t("div",Q,[a[29]||(a[29]=t("i",{class:"detail-icon"},"ðŸ’°",-1)),t("span",Z,r(e.$t("myPass.reservations.total")),1),t("span",ee,r(l.total)+" "+r(l.totalCurrency),1)]),t("div",ae,[a[30]||(a[30]=t("i",{class:"detail-icon"},"ðŸ‘¥",-1)),t("span",se,r(e.$t("myPass.reservations.attendees")),1),t("span",te,r(Pa(l)),1)])])]),t("div",le,[t("button",{class:"btn btn-edit",onClick:e=>function(e){alert(Fe("myPass.messages.reservationEdit")+e.id)}(l)},[a[31]||(a[31]=t("i",{class:"btn-icon"},"âœï¸",-1)),d(" "+r(e.$t("myPass.reservations.edit")),1)],8,oe),t("button",{class:"btn btn-cancel",onClick:e=>function(e){confirm(Fe("myPass.messages.confirmCancel"))&&alert(Fe("myPass.messages.reservationCancel")+e.id)}(l),disabled:!ga(l.payment_status)},[a[32]||(a[32]=t("i",{class:"btn-icon"},"âŒ",-1)),d(" "+r(e.$t("myPass.reservations.cancel")),1)],8,re)])]);var o}),128)),0===Ze.value.length?(v(),s("div",ie,[a[33]||(a[33]=t("div",{class:"empty-icon"},"ðŸ“‹",-1)),t("h3",null,r(e.$t("myPass.reservations.emptyState.title")),1),t("p",null,r(e.$t("myPass.reservations.emptyState.description")),1),t("button",{class:"btn btn-primary",onClick:a[11]||(a[11]=a=>e.$router.push("/tours"))},r(e.$t("myPass.reservations.emptyState.browseTours")),1)])):o("",!0)])])):o("",!0),"info"===Qe.value?(v(),s("section",ne,[t("div",ce,[t("h2",null,r(e.$t("myPass.profile.title")),1),t("p",ue,r(e.$t("myPass.profile.subtitle")),1)]),t("form",{onSubmit:i(ya,["prevent"]),class:"profile-form"},[t("div",de,[t("h3",null,r(e.$t("myPass.profile.personalInfo")),1),t("div",pe,[t("div",me,[t("label",null,r(e.$t("myPass.profile.firstName")),1),n(t("input",{"onUpdate:modelValue":a[12]||(a[12]=e=>ea.value.firstName=e),type:"text",placeholder:e.$t("myPass.profile.firstNamePlaceholder"),required:""},null,8,ve),[[c,ea.value.firstName]])]),t("div",ye,[t("label",null,r(e.$t("myPass.profile.lastName")),1),n(t("input",{"onUpdate:modelValue":a[13]||(a[13]=e=>ea.value.lastName=e),type:"text",placeholder:e.$t("myPass.profile.lastNamePlaceholder"),required:""},null,8,he),[[c,ea.value.lastName]])])])]),t("div",fe,[t("h3",null,r(e.$t("myPass.profile.contactInfo")),1),t("div",Pe,[t("label",null,r(e.$t("myPass.profile.emailAddress")),1),n(t("input",{"onUpdate:modelValue":a[14]||(a[14]=e=>ea.value.email=e),type:"email",placeholder:e.$t("myPass.profile.emailPlaceholder"),required:"",disabled:""},null,8,ge),[[c,ea.value.email]]),t("small",be,r(e.$t("myPass.profile.emailNote")),1)]),t("div",we,[t("label",null,r(e.$t("myPass.profile.mobilePhone")),1),n(t("input",{"onUpdate:modelValue":a[15]||(a[15]=e=>ea.value.phone=e),type:"tel",placeholder:e.$t("myPass.profile.phonePlaceholder")},null,8,$e),[[c,ea.value.phone]])])]),t("div",ke,[t("h3",null,r(e.$t("myPass.profile.addressInfo")),1),t("div",Ne,[t("label",null,r(e.$t("myPass.profile.address")),1),n(t("input",{"onUpdate:modelValue":a[16]||(a[16]=e=>ea.value.address=e),type:"text",placeholder:e.$t("myPass.profile.addressPlaceholder")},null,8,_e),[[c,ea.value.address]])]),t("div",Se,[t("div",Ce,[t("label",null,r(e.$t("myPass.profile.city")),1),n(t("input",{"onUpdate:modelValue":a[17]||(a[17]=e=>ea.value.city=e),type:"text",placeholder:e.$t("myPass.profile.cityPlaceholder")},null,8,je),[[c,ea.value.city]])]),t("div",qe,[t("label",null,r(e.$t("myPass.profile.country")),1),n(t("input",{"onUpdate:modelValue":a[18]||(a[18]=e=>ea.value.country=e),type:"text",placeholder:e.$t("myPass.profile.countryPlaceholder")},null,8,Ue),[[c,ea.value.country]])])]),t("div",Ie,[t("label",null,r(e.$t("myPass.profile.zipCode")),1),n(t("input",{"onUpdate:modelValue":a[19]||(a[19]=e=>ea.value.zip_code=e),type:"text",placeholder:e.$t("myPass.profile.zipPlaceholder")},null,8,Ve),[[c,ea.value.zip_code]])])]),t("div",Te,[t("button",Ae,[a[34]||(a[34]=t("i",{class:"btn-icon"},"ðŸ’¾",-1)),d(" "+r(e.$t("myPass.profile.saveChanges")),1)])])],32)])):o("",!0),"password"===Qe.value?(v(),s("section",Re,[t("div",xe,[t("h2",null,r(e.$t("myPass.password.title")),1),t("p",Xe,r(e.$t("myPass.password.subtitle")),1)]),t("form",{onSubmit:i(ha,["prevent"]),class:"password-form"},[t("div",Le,[t("label",null,r(e.$t("myPass.password.currentPassword")),1),n(t("input",{"onUpdate:modelValue":a[20]||(a[20]=e=>aa.value=e),type:"password",placeholder:e.$t("myPass.password.currentPasswordPlaceholder"),required:""},null,8,Oe),[[c,aa.value]])]),t("div",ze,[t("label",null,r(e.$t("myPass.password.newPassword")),1),n(t("input",{"onUpdate:modelValue":a[21]||(a[21]=e=>sa.value=e),type:"password",placeholder:e.$t("myPass.password.newPasswordPlaceholder"),required:""},null,8,Je),[[c,sa.value]]),t("small",Ee,r(e.$t("myPass.password.passwordNote")),1)]),t("div",Me,[t("label",null,r(e.$t("myPass.password.confirmPassword")),1),n(t("input",{"onUpdate:modelValue":a[22]||(a[22]=e=>ta.value=e),type:"password",placeholder:e.$t("myPass.password.confirmPasswordPlaceholder"),required:""},null,8,Be),[[c,ta.value]])]),t("div",We,[t("button",He,[a[35]||(a[35]=t("i",{class:"btn-icon"},"ðŸ”’",-1)),d(" "+r(e.$t("myPass.password.changePasswordBtn")),1)])]),la.value?(v(),s("div",{key:0,class:u(["message",oa.value?"success":"error"])},[t("i",{class:u(oa.value?"âœ…":"âŒ")},null,2),d(" "+r(la.value),1)],2)):o("",!0)],32)])):o("",!0)])])):(v(),s("div",b,[t("div",w,[t("h2",null,r(e.$t("myPass.login.title")),1),t("form",{onSubmit:i(ma,["prevent"])},[n(t("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>Ge.value=e),type:"email",placeholder:e.$t("myPass.login.email"),required:""},null,8,$),[[c,Ge.value]]),n(t("input",{"onUpdate:modelValue":a[1]||(a[1]=e=>Ye.value=e),type:"password",placeholder:e.$t("myPass.login.password"),required:""},null,8,k),[[c,Ye.value]]),t("div",N,[t("a",{href:"#",onClick:a[2]||(a[2]=i(e=>ra.value=!0,["prevent"]))},r(e.$t("myPass.login.forgotPassword")),1)]),t("button",_,r(e.$t("myPass.login.loginBtn")),1),t("button",{class:"btn btn-secondary signup-btn",type:"button",style:{"margin-top":"10px"},onClick:a[3]||(a[3]=a=>e.$router.push("/signup"))},r(e.$t("myPass.login.signupBtn")),1)],32),Ke.value?(v(),s("div",S,r(Ke.value),1)):o("",!0)]),ra.value?(v(),s("div",{key:0,class:"modal-overlay",onClick:a[7]||(a[7]=e=>ra.value=!1)},[t("div",{class:"modal-content",onClick:a[6]||(a[6]=i(()=>{},["stop"]))},[t("div",C,[t("h3",null,r(e.$t("myPass.resetPassword.title")),1),t("button",{class:"close-btn",onClick:a[4]||(a[4]=e=>ra.value=!1)},"Ã—")]),t("form",{onSubmit:i(wa,["prevent"]),class:"reset-form"},[t("div",j,[t("label",null,r(e.$t("myPass.resetPassword.email")),1),n(t("input",{"onUpdate:modelValue":a[5]||(a[5]=e=>ia.value=e),type:"email",placeholder:e.$t("myPass.resetPassword.emailPlaceholder"),required:""},null,8,q),[[c,ia.value]])]),t("button",{class:"btn btn-primary",type:"submit",disabled:na.value},r(na.value?e.$t("myPass.resetPassword.sending"):e.$t("myPass.resetPassword.sendBtn")),9,U),ca.value?(v(),s("div",{key:0,class:u(["message",ua.value?"success":"error"])},r(ca.value),3)):o("",!0)],32)])])):o("",!0)]))]))}},[["__scopeId","data-v-ddfdefda"]]);export{Fe as default};
