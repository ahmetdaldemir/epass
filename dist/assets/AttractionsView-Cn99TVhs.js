import{_ as M,r as _,g as E,h as V,a as c,b as s,d as N,t as g,F as T,e as B,i as S,o as a,j as U,k as y,f as h,l as F,m as k}from"./index-7ALJyXWv.js";const j={class:"attractions"},H={class:"attractions-list"},P={class:"container"},R={key:0,class:"loading-state"},W={key:1,class:"error-state"},z={key:2,class:"attractions-grid"},G={class:"attraction-image"},Y=["src","alt"],q={class:"attraction-content"},J={class:"attraction-meta"},K={class:"price"},O={class:"duration"},Q={class:"attraction-actions"},X=["onClick"],Z={key:3,class:"no-results"},tt={__name:"AttractionsView",setup(et,{expose:b}){const m=_([]),p=_(!1),i=_(null),l=_("en"),$=computed(()=>{const e=localStorage.getItem("selectedCurrency")||"EUR";return A(e)}),u=async()=>{p.value=!0,i.value=null;try{const e=`https://searchyourtour.com/api/tours?token=ad5257a5-efdd-4314-9e5e-b56aabe321f1&language_id=${C(l.value)}&currency_id=${$.value}&limit=200&IpAdrress=78.177.166.135`,t=await fetch(e);if(!t.ok)throw new Error("Failed to fetch attractions");const o=(await t.json()||[]).filter(r=>{var d;return((d=r.destination)==null?void 0:d.id)===404&&r.is_active===!0});console.log(o),m.value=o}catch(e){i.value="Failed to load attractions. Please try again later.",console.error("Error fetching attractions:",e)}finally{p.value=!1}},C=e=>({tr:2,de:6,en:1,ar:3,es:4,fr:5,it:7,pt:8,zh:10,ja:11,ru:9})[e]||1,A=e=>({EUR:4,USD:5,GBP:6,TRY:7})[e]||4,v=e=>{var t,n;return((n=(t=e.content)==null?void 0:t[0])==null?void 0:n.name)||"Unnamed Attraction"},w=e=>{var r,d;const t=(d=(r=e.content)==null?void 0:r[0])==null?void 0:d.meta_content;if(!t)return"No description available";const n=document.createElement("div");n.innerHTML=t;const o=n.textContent||n.innerText||"";return o.length>120?o.substring(0,120)+"...":o},I=e=>{var t,n;return((n=(t=e.files)==null?void 0:t[0])==null?void 0:n.url)||"https://via.placeholder.com/300x200?text=Istanbul+Attraction"},x=e=>{var o;const t=(o=e.tour_price)==null?void 0:o[0];return t?`${t.currency_icon||"$"}${t.price}`:"CALL"},L=e=>{const t=e.tour_duraction,n=e.tour_duraction_type;return t?n==="hour"?`${t} Hr`:n==="day"?`${t} Day`:n==="week"?`${t} Week`:n==="month"?`${t} Month`:n==="minutes"||n==="minute"||n==="min"?`${t} Min`:`${t} ${n}s`:"Duration not specified"},D=e=>{console.log("Adding attraction to wishlist:",e)};b({updateLanguage:e=>{l.value=e,u()}});const f=e=>{e.detail&&e.detail.currency&&(console.log("AttractionsView: Currency changed to:",e.detail.currency,"ID:",e.detail.currencyId),u())};return E(()=>{window.addEventListener("currency-changed",f);const e=localStorage.getItem("selectedLanguage")||"en";l.value=e,u()}),onBeforeUnmount(()=>{window.removeEventListener("currency-changed",f)}),V(()=>localStorage.getItem("selectedLanguage"),e=>{e&&e!==l.value&&(l.value=e,u())}),(e,t)=>{const n=S("router-link");return a(),c("div",j,[t[6]||(t[6]=s("section",{class:"hero-section"},[s("div",{class:"container"},[s("h1",null,"Istanbul Attractions"),s("p",null,"Discover the most popular attractions and tours included in your pass")])],-1)),s("section",H,[s("div",P,[p.value?(a(),c("div",R,t[1]||(t[1]=[s("div",{class:"loading-spinner"},null,-1),s("p",null,"Loading Istanbul attractions...",-1)]))):i.value?(a(),c("div",W,[s("p",null,g(i.value),1),s("button",{onClick:u,class:"btn btn-primary"},"Try Again")])):(a(),c("div",z,[(a(!0),c(T,null,B(m.value,o=>(a(),U(n,{key:o.id,to:`/tour/${o.id}`,class:"attraction-card",style:{"text-decoration":"none",color:"inherit",display:"block",height:"100%"}},{default:y(()=>[s("div",G,[s("img",{src:I(o),alt:v(o)},null,8,Y)]),s("div",q,[s("h3",null,g(v(o)),1),s("p",null,g(w(o)),1),s("div",J,[s("span",K,g(x(o)),1),s("span",O,[t[2]||(t[2]=s("i",{class:"fas fa-clock"},null,-1)),h(" "+g(L(o)),1)])]),s("div",Q,[F(n,{onClick:t[0]||(t[0]=k(()=>{},["stop"])),to:`/tour/${o.id}`,class:"btn btn-primary"},{default:y(()=>t[3]||(t[3]=[h("View")])),_:2,__:[3]},1032,["to"]),s("button",{onClick:k(r=>D(o.id),["stop"]),class:"btn btn-secondary"},t[4]||(t[4]=[s("i",{class:"fas fa-heart"},null,-1)]),8,X)])])]),_:2},1032,["to"]))),128))])),!p.value&&!i.value&&m.value.length===0?(a(),c("div",Z,t[5]||(t[5]=[s("p",null,"No Istanbul attractions found at the moment.",-1)]))):N("",!0)])])])}}},ot=M(tt,[["__scopeId","data-v-65e45d5f"]]);export{ot as default};
