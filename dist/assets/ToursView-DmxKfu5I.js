import{r as e,A as a,o as t,D as l,w as n,c as s,a as r,b as o,k as i,X as u,F as c,l as d,t as v,f as p,h,I as m,e as g,g as f,i as y}from"./vendor-D8r79KCq.js";import{_ as k}from"./index-D7LB1wtG.js";import"./swiper-WOzPqNul.js";const w={class:"tours"},b={class:"tours-section"},_={class:"container"},x={class:"tours-header"},$={class:"filters"},D=["value"],C={key:0,class:"loading-state"},E={key:1,class:"error-state"},I={key:2,class:"tours-grid"},L={class:"tour-image"},T=["src","alt"],U={class:"tour-overlay"},A=["onClick"],H={class:"tour-content"},j={class:"tour-meta"},S={class:"destination"},F={class:"duration"},V={class:"tour-footer"},N={class:"tour-price"},P={key:3,class:"no-results"},R=k({__name:"ToursView",setup(k,{expose:R}){const B=e(""),q=e(""),z=e([]),G=e(!1),M=e(null),X=e("en"),Y=a(()=>{const e=localStorage.getItem("selectedCurrency")||"EUR";return O(e)}),J=async()=>{G.value=!0,M.value=null;try{const e=`https://backend.searchyourtour.com/api/tours?token=ad5257a5-efdd-4314-9e5e-b56aabe321f1&language_id=${K(X.value)}&currency_id=${Y.value}&limit=100&IpAdrress=78.177.166.135`,a=await fetch(e);if(!a.ok)throw new Error("Failed to fetch tours");const t=await a.json();z.value=t||[]}catch(e){M.value="Failed to load tours. Please try again later."}finally{G.value=!1}},K=e=>({tr:2,de:6,en:1,ar:3,es:4,fr:5,it:7,pt:8,zh:10,ja:11,ru:9}[e]||1),O=e=>({EUR:4,USD:5,GBP:6,TRY:7}[e]||4),Q=e=>{var a,t;return(null==(t=null==(a=e.content)?void 0:a[0])?void 0:t.name)||"Unnamed Tour"},W=e=>{var a,t;const l=null==(t=null==(a=e.content)?void 0:a[0])?void 0:t.meta_content;if(!l)return"No description available";const n=document.createElement("div");n.innerHTML=l;const s=n.textContent||n.innerText||"";return s.length>150?s.substring(0,150)+"...":s},Z=e=>{var a,t;return(null==(t=null==(a=e.files)?void 0:a[0])?void 0:t.url)||"https://via.placeholder.com/400x250?text=No+Image"},ee=e=>{var a;return(null==(a=e.destination)?void 0:a.name)||"Unknown Destination"},ae=e=>{var a;const t=null==(a=e.tour_price)?void 0:a[0];if(!t)return"Price on request";return`${t.currency_icon||"$"}${t.price}`},te=e=>{const a=e.tour_duraction,t=e.tour_duraction_type||"hour";return a?"hour"===t?`${a} ${1===a?"Hour":"Hours"}`:"day"===t?`${a} ${1===a?"Day":"Days"}`:`${a} ${t}s`:"Duration not specified"},le=a(()=>{const e=z.value.map(e=>{var a;return null==(a=e.destination)?void 0:a.name}).filter(Boolean);return[...new Set(e)]}),ne=a(()=>z.value.filter(e=>{var a;const t=!B.value||(null==(a=e.destination)?void 0:a.name)===B.value,l=!q.value||(()=>{const a=e.tour_duraction;switch(q.value){case"1-3":return a>=1&&a<=3;case"4-6":return a>=4&&a<=6;case"7+":return a>=7;default:return!0}})();return t&&l})),se=()=>{B.value="",q.value=""};R({updateLanguage:e=>{X.value=e,J()}});const re=e=>{e.detail&&e.detail.currency&&J()};return t(()=>{window.addEventListener("currency-changed",re);const e=localStorage.getItem("selectedLanguage")||"en";X.value=e,J()}),l(()=>{window.removeEventListener("currency-changed",re)}),n(()=>localStorage.getItem("selectedLanguage"),e=>{e&&e!==X.value&&(X.value=e,J())}),(e,a)=>{const t=p("router-link");return h(),s("div",w,[a[10]||(a[10]=r("section",{class:"hero-section"},[r("div",{class:"container"},[r("div",{class:"hero-content"},[r("h2",null,"Explore the city's rich history and culture with our expert guides. Visit iconic landmarks with skip-the-line access and insider knowledge.")])])],-1)),r("section",b,[r("div",_,[r("div",x,[a[4]||(a[4]=r("h2",null,"Available Tours",-1)),r("div",$,[i(r("select",{"onUpdate:modelValue":a[0]||(a[0]=e=>B.value=e),class:"filter-select"},[a[2]||(a[2]=r("option",{value:""},"All Destinations",-1)),(h(!0),s(c,null,d(le.value,e=>(h(),s("option",{key:e,value:e},v(e),9,D))),128))],512),[[u,B.value]]),i(r("select",{"onUpdate:modelValue":a[1]||(a[1]=e=>q.value=e),class:"filter-select"},a[3]||(a[3]=[r("option",{value:""},"All Durations",-1),r("option",{value:"1-3"},"1-3 Hours",-1),r("option",{value:"4-6"},"4-6 Hours",-1),r("option",{value:"7+"},"7+ Hours",-1)]),512),[[u,q.value]])])]),G.value?(h(),s("div",C,a[5]||(a[5]=[r("div",{class:"loading-spinner"},null,-1),r("p",null,"Loading tours...",-1)]))):M.value?(h(),s("div",E,[r("p",null,v(M.value),1),r("button",{onClick:J,class:"btn btn-primary"},"Try Again")])):(h(),s("div",I,[(h(!0),s(c,null,d(ne.value,e=>(h(),m(t,{key:e.id,to:`/tour/${e.id}`,class:"tour-card",style:{"text-decoration":"none",color:"inherit",display:"flex","flex-direction":"column",height:"100%"}},{default:g(()=>[r("div",L,[r("img",{src:Z(e),alt:Q(e)},null,8,T),r("div",U,[r("button",{onClick:f(a=>{e.id},["stop"]),class:"wishlist-btn"},a[6]||(a[6]=[r("i",{class:"fas fa-heart"},null,-1)]),8,A)])]),r("div",H,[r("h3",null,v(Q(e)),1),r("p",null,v(W(e)),1),r("div",j,[r("span",S,[a[7]||(a[7]=r("i",{class:"fas fa-map-marker-alt"},null,-1)),y(" "+v(ee(e)),1)]),r("span",F,[a[8]||(a[8]=r("i",{class:"fas fa-clock"},null,-1)),y(" "+v(te(e)),1)])]),r("div",V,[r("div",N,v(ae(e)),1)])])]),_:2},1032,["to"]))),128))])),G.value||M.value||0!==ne.value.length?o("",!0):(h(),s("div",P,[a[9]||(a[9]=r("p",null,"No tours found matching your criteria.",-1)),r("button",{onClick:se,class:"btn btn-primary"},"Clear Filters")]))])])])}}},[["__scopeId","data-v-4e44e0d1"]]);export{R as default};
