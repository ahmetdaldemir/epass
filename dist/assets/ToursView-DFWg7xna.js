import{r as e,c as a,o as t,w as l,P as n,k as s,l as r,j as o,m as u,I as i,_ as c,F as d,L as v,x as p,p as m,t as h,U as g,n as f,q as y,v as _}from"./vendor-C-dIp69U.js";import{B as k}from"./Breadcrumb-Sed0oLr7.js";import{_ as b}from"./index-BPtefy7M.js";/* empty css                                                                   */import"./swiper-WOzPqNul.js";const w={class:"tours"},x={class:"container"},$={class:"tours-section"},I={class:"container"},L={class:"tours-header"},j={class:"filters"},U=["value"],C={key:0,class:"loading-state"},D={key:1,class:"error-state"},E={key:2,class:"tours-grid"},T={class:"tour-image"},H=["src","alt"],A={class:"tour-overlay"},B=["onClick"],S={key:0,class:"sell-out-badge"},F={class:"tour-content"},M={class:"tour-meta"},P={class:"destination"},V={class:"duration"},q={class:"tour-footer"},N={class:"tour-price"},R={key:3,class:"no-results"},z=b({__name:"ToursView",setup(b,{expose:z}){const G=e(""),Y=e(""),J=e([]),K=e(!1),O=e(null),Q=e(null),W=e(null),X=e("en"),Z=a(()=>{const e=localStorage.getItem("selectedCurrency")||"EUR";return te(e)}),ee=async()=>{K.value=!0,O.value=null;try{const e=`https://backend.searchyourtour.com/api/tours?token=ad5257a5-efdd-4314-9e5e-b56aabe321f1&language_id=${ae(X.value)}&currency_id=${Z.value}&limit=100&IpAdrress=78.177.166.135`,a=await fetch(e);if(!a.ok)throw new Error("Failed to fetch tours");const t=await a.json();J.value=t||[]}catch(e){O.value="Failed to load tours. Please try again later."}finally{K.value=!1}},ae=e=>({tr:2,de:6,en:1,ar:3,es:4,fr:5,it:7,pt:8,zh:10,ja:11,ru:9}[e]||1),te=e=>({EUR:4,USD:5,GBP:6,TRY:7}[e]||4),le=e=>{var a,t;return(null==(t=null==(a=e.content)?void 0:a[0])?void 0:t.name)||"Unnamed Tour"},ne=e=>{var a,t;const l=null==(t=null==(a=e.content)?void 0:a[0])?void 0:t.meta_content;if(!l)return"No description available";const n=document.createElement("div");n.innerHTML=l;const s=n.textContent||n.innerText||"";return s.length>150?s.substring(0,150)+"...":s},se=e=>{var a,t;return(null==(t=null==(a=e.files)?void 0:a[0])?void 0:t.url)||"https://via.placeholder.com/400x250?text=No+Image"},re=e=>{var a;return(null==(a=e.destination)?void 0:a.name)||"Unknown Destination"},oe=e=>{var a;const t=null==(a=e.tour_price)?void 0:a[0];if(!t)return"Price on request";return`${t.currency_icon||"$"}${t.price}`},ue=e=>{const a=e.tour_duraction,t=e.tour_duraction_type||"hour";return a?"hour"===t?`${a} ${1===a?"Hour":"Hours"}`:"day"===t?`${a} ${1===a?"Day":"Days"}`:`${a} ${t}s`:"Duration not specified"},ie=()=>{if(0===J.value.length)return;const e=Math.floor(Math.random()*J.value.length);W.value=J.value[e].id},ce=a(()=>{const e=J.value.map(e=>{var a;return null==(a=e.destination)?void 0:a.name}).filter(Boolean);return[...new Set(e)]}),de=a(()=>J.value.filter(e=>{var a;const t=!G.value||(null==(a=e.destination)?void 0:a.name)===G.value,l=!Y.value||(()=>{const a=e.tour_duraction;switch(Y.value){case"1-3":return a>=1&&a<=3;case"4-6":return a>=4&&a<=6;case"7+":return a>=7;default:return!0}})();return t&&l})),ve=()=>{G.value="",Y.value=""};z({updateLanguage:e=>{X.value=e,ee()}});const pe=e=>{e.detail&&e.detail.currency&&ee()};return t(()=>{window.addEventListener("currency-changed",pe);const e=localStorage.getItem("selectedLanguage")||"en";X.value=e,ee(),l(J,e=>{e.length>0&&!Q.value&&(()=>{ie();const e=36e5*Math.random()+108e5;Q.value=setInterval(()=>{ie()},e)})()},{immediate:!0})}),n(()=>{window.removeEventListener("currency-changed",pe),Q.value&&(clearInterval(Q.value),Q.value=null)}),l(()=>localStorage.getItem("selectedLanguage"),e=>{e&&e!==X.value&&(X.value=e,ee())}),(e,a)=>{const t=m("router-link");return h(),s("div",w,[a[10]||(a[10]=r("section",{class:"hero-section"},[r("div",{class:"container"},[r("div",{class:"hero-content"},[r("h2",null,"Explore the city's rich history and culture with our expert guides. Visit iconic landmarks with skip-the-line access and insider knowledge.")])])],-1)),r("div",x,[o(k)]),r("section",$,[r("div",I,[r("div",L,[a[4]||(a[4]=r("h2",null,"Available Tours",-1)),r("div",j,[i(r("select",{"onUpdate:modelValue":a[0]||(a[0]=e=>G.value=e),class:"filter-select"},[a[2]||(a[2]=r("option",{value:""},"All Destinations",-1)),(h(!0),s(d,null,v(ce.value,e=>(h(),s("option",{key:e,value:e},p(e),9,U))),128))],512),[[c,G.value]]),i(r("select",{"onUpdate:modelValue":a[1]||(a[1]=e=>Y.value=e),class:"filter-select"},a[3]||(a[3]=[r("option",{value:""},"All Durations",-1),r("option",{value:"1-3"},"1-3 Hours",-1),r("option",{value:"4-6"},"4-6 Hours",-1),r("option",{value:"7+"},"7+ Hours",-1)]),512),[[c,Y.value]])])]),K.value?(h(),s("div",C,a[5]||(a[5]=[r("div",{class:"loading-spinner"},null,-1),r("p",null,"Loading tours...",-1)]))):O.value?(h(),s("div",D,[r("p",null,p(O.value),1),r("button",{onClick:ee,class:"btn btn-primary"},"Try Again")])):(h(),s("div",E,[(h(!0),s(d,null,v(de.value,e=>(h(),g(t,{key:e.id,to:`${e.slug_url}`,class:"tour-card",style:{"text-decoration":"none",color:"inherit",display:"flex","flex-direction":"column",height:"100%"}},{default:f(()=>{return[r("div",T,[r("img",{src:se(e),alt:le(e)},null,8,H),r("div",A,[r("button",{onClick:y(a=>{e.id},["stop"]),class:"wishlist-btn"},a[6]||(a[6]=[r("i",{class:"fas fa-heart"},null,-1)]),8,B)]),(t=e.id,W.value===t?(h(),s("div",S," Likely to sell out ")):u("",!0))]),r("div",F,[r("h3",null,p(le(e)),1),r("p",null,p(ne(e)),1),r("div",M,[r("span",P,[a[7]||(a[7]=r("i",{class:"fas fa-map-marker-alt"},null,-1)),_(" "+p(re(e)),1)]),r("span",V,[a[8]||(a[8]=r("i",{class:"fas fa-clock"},null,-1)),_(" "+p(ue(e)),1)])]),r("div",q,[r("div",N,p(oe(e)),1)])])];var t}),_:2},1032,["to"]))),128))])),K.value||O.value||0!==de.value.length?u("",!0):(h(),s("div",R,[a[9]||(a[9]=r("p",null,"No tours found matching your criteria.",-1)),r("button",{onClick:ve,class:"btn btn-primary"},"Clear Filters")]))])])])}}},[["__scopeId","data-v-1012d049"]]);export{z as default};
