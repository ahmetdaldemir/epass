import{_ as H,r as u,c as m,g as P,h as j,a as l,n as R,b as s,d as q,w as T,p as D,F as C,e as b,t as i,i as G,o as a,j as z,k as O,m as W,f as x}from"./index-7ALJyXWv.js";const Y={class:"tours"},J={class:"tours-section"},K={class:"container"},Q={class:"tours-header"},X={class:"filters"},Z=["value"],ee={key:0,class:"loading-state"},te={key:1,class:"error-state"},se={key:2,class:"tours-grid"},ne={class:"tour-image"},oe=["src","alt"],re={class:"tour-overlay"},ae=["onClick"],le={class:"tour-content"},ie={class:"tour-meta"},ue={class:"destination"},ce={class:"duration"},de={class:"tour-footer"},ve={class:"tour-price"},pe={key:3,class:"no-results"},ge={__name:"ToursView",setup(he,{expose:$}){const c=u(""),d=u(""),f=u([]),h=u(!1),v=u(null),p=u("en"),I=m(()=>{const t=localStorage.getItem("selectedCurrency")||"EUR";return M(t)}),g=async()=>{h.value=!0,v.value=null;try{const t=`https://searchyourtour.com/api/tours?token=ad5257a5-efdd-4314-9e5e-b56aabe321f1&language_id=${L(p.value)}&currency_id=${I.value}&limit=100&IpAdrress=78.177.166.135`,e=await fetch(t);if(!e.ok)throw new Error("Failed to fetch tours");const o=await e.json();f.value=o||[]}catch(t){v.value="Failed to load tours. Please try again later.",console.error("Error fetching tours:",t)}finally{h.value=!1}},L=t=>({tr:2,de:6,en:1,ar:3,es:4,fr:5,it:7,pt:8,zh:10,ja:11,ru:9})[t]||1,M=t=>({EUR:4,USD:5,GBP:6,TRY:7})[t]||4,_=t=>{var e,o;return((o=(e=t.content)==null?void 0:e[0])==null?void 0:o.name)||"Unnamed Tour"},E=t=>{var r,w;const e=(w=(r=t.content)==null?void 0:r[0])==null?void 0:w.meta_content;if(!e)return"No description available";const o=document.createElement("div");o.innerHTML=e;const n=o.textContent||o.innerText||"";return n.length>150?n.substring(0,150)+"...":n},N=t=>{var e,o;return((o=(e=t.files)==null?void 0:e[0])==null?void 0:o.url)||"https://via.placeholder.com/400x250?text=No+Image"},V=t=>{var e;return((e=t.destination)==null?void 0:e.name)||"Unknown Destination"},S=t=>{var n;const e=(n=t.tour_price)==null?void 0:n[0];return e?`${e.currency_icon||"$"}${e.price}`:"Price on request"},U=t=>{const e=t.tour_duraction,o=t.tour_duraction_type||"hour";return e?o==="hour"?`${e} ${e===1?"Hour":"Hours"}`:o==="day"?`${e} ${e===1?"Day":"Days"}`:`${e} ${o}s`:"Duration not specified"},B=m(()=>{const t=f.value.map(e=>{var o;return(o=e.destination)==null?void 0:o.name}).filter(Boolean);return[...new Set(t)]}),y=m(()=>f.value.filter(t=>{var n;const e=!c.value||((n=t.destination)==null?void 0:n.name)===c.value,o=!d.value||(()=>{const r=t.tour_duraction;switch(d.value){case"1-3":return r>=1&&r<=3;case"4-6":return r>=4&&r<=6;case"7+":return r>=7;default:return!0}})();return e&&o})),A=t=>{console.log("Adding tour to wishlist:",t)},F=()=>{c.value="",d.value=""};$({updateLanguage:t=>{p.value=t,g()}});const k=t=>{t.detail&&t.detail.currency&&(console.log("ToursView: Currency changed to:",t.detail.currency,"ID:",t.detail.currencyId),g())};return P(()=>{window.addEventListener("currency-changed",k);const t=localStorage.getItem("selectedLanguage")||"en";p.value=t,g()}),onBeforeUnmount(()=>{window.removeEventListener("currency-changed",k)}),j(()=>localStorage.getItem("selectedLanguage"),t=>{t&&t!==p.value&&(p.value=t,g())}),(t,e)=>{const o=G("router-link");return a(),l("div",Y,[e[10]||(e[10]=R('<section class="hero-section" data-v-e675d209><div class="container" data-v-e675d209><div class="hero-content" data-v-e675d209><h1 class="hero-title" data-v-e675d209>Discover Istanbul with Our Guided Tours</h1><p class="hero-subtitle" data-v-e675d209>Explore the city&#39;s rich history and culture with our expert guides</p></div></div></section>',1)),s("section",J,[s("div",K,[s("div",Q,[e[4]||(e[4]=s("h2",null,"Available Tours",-1)),s("div",X,[T(s("select",{"onUpdate:modelValue":e[0]||(e[0]=n=>c.value=n),class:"filter-select"},[e[2]||(e[2]=s("option",{value:""},"All Destinations",-1)),(a(!0),l(C,null,b(B.value,n=>(a(),l("option",{key:n,value:n},i(n),9,Z))),128))],512),[[D,c.value]]),T(s("select",{"onUpdate:modelValue":e[1]||(e[1]=n=>d.value=n),class:"filter-select"},e[3]||(e[3]=[s("option",{value:""},"All Durations",-1),s("option",{value:"1-3"},"1-3 Hours",-1),s("option",{value:"4-6"},"4-6 Hours",-1),s("option",{value:"7+"},"7+ Hours",-1)]),512),[[D,d.value]])])]),h.value?(a(),l("div",ee,e[5]||(e[5]=[s("div",{class:"loading-spinner"},null,-1),s("p",null,"Loading tours...",-1)]))):v.value?(a(),l("div",te,[s("p",null,i(v.value),1),s("button",{onClick:g,class:"btn btn-primary"},"Try Again")])):(a(),l("div",se,[(a(!0),l(C,null,b(y.value,n=>(a(),z(o,{key:n.id,to:`/tour/${n.id}`,class:"tour-card",style:{"text-decoration":"none",color:"inherit",display:"flex","flex-direction":"column",height:"100%"}},{default:O(()=>[s("div",ne,[s("img",{src:N(n),alt:_(n)},null,8,oe),s("div",re,[s("button",{onClick:W(r=>A(n.id),["stop"]),class:"wishlist-btn"},e[6]||(e[6]=[s("i",{class:"fas fa-heart"},null,-1)]),8,ae)])]),s("div",le,[s("h3",null,i(_(n)),1),s("p",null,i(E(n)),1),s("div",ie,[s("span",ue,[e[7]||(e[7]=s("i",{class:"fas fa-map-marker-alt"},null,-1)),x(" "+i(V(n)),1)]),s("span",ce,[e[8]||(e[8]=s("i",{class:"fas fa-clock"},null,-1)),x(" "+i(U(n)),1)])]),s("div",de,[s("div",ve,i(S(n)),1)])])]),_:2},1032,["to"]))),128))])),!h.value&&!v.value&&y.value.length===0?(a(),l("div",pe,[e[9]||(e[9]=s("p",null,"No tours found matching your criteria.",-1)),s("button",{onClick:F,class:"btn btn-primary"},"Clear Filters")])):q("",!0)])])])}}},_e=H(ge,[["__scopeId","data-v-e675d209"]]);export{_e as default};
