import{r as t,c as a,o as n,Q as e,w as r,k as o,l as s,x as i,m as l,F as c,L as u,J as d,p as v,t as p,U as m,n as h,v as g,j as $,q as y}from"./vendor-DH4wiDP_.js";import{_ as f,u as _}from"./index-BOi1MMrK.js";import"./swiper-WOzPqNul.js";const k={class:"hero-section"},b={class:"container"},w={class:"attractions-list"},x={class:"container"},L={key:0,class:"loading-state"},C={key:1,class:"error-state"},j={key:2,class:"attractions-grid"},A={class:"attraction-image"},E=["src","alt"],I={class:"attraction-content"},S={class:"attraction-meta"},R={class:"price"},U={class:"duration"},T={class:"attraction-actions"},D=["onClick"],q={key:3,class:"no-results"},z=f({__name:"AttractionsView",setup(f,{expose:z}){const{t:B,locale:F}=_(),G=t([]),H=t(!1),J=t(null),M=t("en"),P=a(()=>{const t=localStorage.getItem("selectedCurrency")||"EUR";return K(t)}),Q=a(()=>"ar"===F.value),V=async()=>{H.value=!0,J.value=null;try{const t=`https://backend.searchyourtour.com/api/tours?token=ad5257a5-efdd-4314-9e5e-b56aabe321f1&language_id=${Y(M.value)}&currency_id=${P.value}&limit=200&IpAdrress=78.177.166.135`,a=await fetch(t);if(!a.ok)throw new Error(B("attractions.error"));const n=(await a.json()||[]).filter(t=>{var a,n;return 404===(null==(a=t.destination)?void 0:a.id)&&!0===t.is_active&&t.tour_price&&t.tour_price.length>0&&(null==(n=t.tour_price[0])?void 0:n.price)&&t.tour_price[0].price>0});G.value=n}catch(t){J.value=B("attractions.error")}finally{H.value=!1}},Y=t=>({tr:2,de:6,en:1,ar:3,es:4,fr:5,it:7,pt:8,zh:10,ja:11,ru:9}[t]||1),K=t=>({EUR:4,USD:5,GBP:6,TRY:7}[t]||4),N=t=>{var a,n;return(null==(n=null==(a=t.content)?void 0:a[0])?void 0:n.name)||B("attractions.unnamedAttraction")},O=t=>{var a,n;const e=null==(n=null==(a=t.content)?void 0:a[0])?void 0:n.meta_content;if(!e)return B("attractions.noDescription");const r=document.createElement("div");r.innerHTML=e;const o=r.textContent||r.innerText||"";return o.length>120?o.substring(0,120)+"...":o},W=t=>{var a,n;return(null==(n=null==(a=t.files)?void 0:a[0])?void 0:n.url)||"https://via.placeholder.com/300x200?text=Istanbul+Attraction"},X=t=>{var a;const n=null==(a=t.tour_price)?void 0:a[0];if(!n)return"CALL";return`${n.currency_icon||"$"}${n.price}`},Z=t=>{const a=t.tour_duraction,n=t.tour_duraction_type;return a?"hour"===n?`${a} ${B(1===a?"attractions.duration.hour":"attractions.duration.hours")}`:"day"===n?`${a} ${B(1===a?"attractions.duration.day":"attractions.duration.days")}`:"week"===n?`${a} ${B(1===a?"attractions.duration.week":"attractions.duration.weeks")}`:"month"===n?`${a} ${B(1===a?"attractions.duration.month":"attractions.duration.months")}`:"minutes"===n||"minute"===n||"min"===n?`${a} ${B("attractions.duration.minute")}`:`${a} ${n}s`:B("attractions.duration.notSpecified")};z({updateLanguage:t=>{M.value=t,V()}});const tt=t=>{t.detail&&t.detail.currency&&V()};return n(()=>{window.addEventListener("currency-changed",tt);const t=localStorage.getItem("selectedLanguage")||"en";M.value=t,V()}),e(()=>{window.removeEventListener("currency-changed",tt)}),r(()=>localStorage.getItem("selectedLanguage"),t=>{t&&t!==M.value&&(M.value=t,V())}),(t,a)=>{const n=v("router-link");return p(),o("div",{class:d(["attractions",{rtl:Q.value}])},[s("section",k,[s("div",b,[s("h1",null,i(t.$t("attractions.hero.title")),1),s("h2",null,i(t.$t("attractions.hero.subtitle")),1),s("p",null,i(t.$t("attractions.hero.description")),1)])]),s("section",w,[s("div",x,[H.value?(p(),o("div",L,[a[1]||(a[1]=s("div",{class:"loading-spinner"},null,-1)),s("p",null,i(t.$t("attractions.loading")),1)])):J.value?(p(),o("div",C,[s("p",null,i(J.value),1),s("button",{onClick:V,class:"btn btn-primary"},i(t.$t("attractions.tryAgain")),1)])):(p(),o("div",j,[(p(!0),o(c,null,u(G.value,e=>(p(),m(n,{key:e.id,to:`/tour/${e.id}`,class:"attraction-card",style:{"text-decoration":"none",color:"inherit",display:"block",height:"100%"}},{default:h(()=>[s("div",A,[s("img",{src:W(e),alt:N(e)},null,8,E)]),s("div",I,[s("h3",null,i(N(e)),1),s("p",null,i(O(e)),1),s("div",S,[s("span",R,i(X(e)),1),s("span",U,[a[2]||(a[2]=s("i",{class:"fas fa-clock"},null,-1)),g(" "+i(Z(e)),1)])]),s("div",T,[$(n,{onClick:a[0]||(a[0]=y(()=>{},["stop"])),to:`/tour/${e.id}`,class:"btn btn-primary"},{default:h(()=>[g(i(t.$t("attractions.view")),1)]),_:2},1032,["to"]),s("button",{onClick:y(t=>{e.id},["stop"]),class:"btn btn-secondary"},a[3]||(a[3]=[s("i",{class:"fas fa-heart"},null,-1)]),8,D)])])]),_:2},1032,["to"]))),128))])),H.value||J.value||0!==G.value.length?l("",!0):(p(),o("div",q,[s("p",null,i(t.$t("attractions.noResults")),1)]))])])],2)}}},[["__scopeId","data-v-089aa01b"]]);export{z as default};
