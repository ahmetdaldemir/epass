import{r as e,o as a,k as s,l as t,m as l,x as o,q as r,I as i,Y as n,J as c,v as u,F as d,L as p,t as m}from"./vendor-DH4wiDP_.js";import{_ as v,u as y}from"./index-BOi1MMrK.js";import"./swiper-WOzPqNul.js";const h={class:"my-pass-panel"},f={key:0,class:"login-outer"},P={class:"login-box"},g=["placeholder"],b=["placeholder"],w={class:"forgot-password"},$={class:"btn btn-primary login-btn",type:"submit"},k={key:0,class:"error"},N={class:"modal-header"},S={class:"form-group"},C=["placeholder"],j=["disabled"],U={key:1,class:"dashboard-container"},q={class:"side-menu"},_={class:"user-profile"},I={class:"user-avatar"},V={class:"user-info"},T={class:"nav-menu"},A={class:"main-content"},R={key:0,class:"content-section"},X={class:"section-header"},x={class:"section-subtitle"},L={class:"reservation-list"},O={class:"reservation-header"},z={class:"reservation-details"},J={class:"detail-row"},E={class:"detail-item"},M={class:"detail-label"},W={class:"detail-value"},H={class:"detail-item"},B={class:"detail-label"},F={class:"detail-value"},D={class:"detail-row"},G={class:"detail-item"},Y={class:"detail-label"},K={class:"detail-value price"},Q={class:"detail-item"},Z={class:"detail-label"},ee={class:"detail-value"},ae={class:"reservation-actions"},se=["onClick"],te=["onClick","disabled"],le={key:0,class:"empty-state"},oe={key:1,class:"content-section"},re={class:"section-header"},ie={class:"section-subtitle"},ne={class:"form-section"},ce={class:"form-row"},ue={class:"form-group"},de=["placeholder"],pe={class:"form-group"},me=["placeholder"],ve={class:"form-section"},ye={class:"form-group"},he=["placeholder"],fe={class:"field-note"},Pe={class:"form-group"},ge=["placeholder"],be={class:"form-section"},we={class:"form-group"},$e=["placeholder"],ke={class:"form-row"},Ne={class:"form-group"},Se=["placeholder"],Ce={class:"form-group"},je=["placeholder"],Ue={class:"form-group"},qe=["placeholder"],_e={class:"form-actions"},Ie={class:"btn btn-primary",type:"submit"},Ve={key:2,class:"content-section"},Te={class:"section-header"},Ae={class:"section-subtitle"},Re={class:"form-group"},Xe=["placeholder"],xe={class:"form-group"},Le=["placeholder"],Oe={class:"field-note"},ze={class:"form-group"},Je=["placeholder"],Ee={class:"form-actions"},Me={class:"btn btn-primary",type:"submit"},We=v({__name:"MyPassView",setup(v){const{t:We}=y(),He=e(!1),Be=e(""),Fe=e(""),De=e(""),Ge=e("reservations"),Ye=e([]),Ke=e({firstName:"",lastName:"",email:"",phone:"",address:"",city:"",country:"",zip_code:""}),Qe=e(""),Ze=e(""),ea=e(""),aa=e(""),sa=e(!1),ta=e(!1),la=e(""),oa=e(!1),ra=e(""),ia=e(!1);async function na(e){try{const a=await fetch(`https://backend.searchyourtour.com/api/customer/profile/${e}`,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest"}}),s=await a.json();if(s.status){const e=(s.data.fullname||"").split(" ");Ke.value={firstName:e[0]||"",lastName:e.slice(1).join(" ")||"",email:s.data.email||"",phone:s.data.phone||"",address:s.data.address||"",city:s.data.city||"",country:s.data.country||"",zip_code:s.data.zip_code||""}}}catch(a){}}async function ca(e){try{const a=await fetch(`https://backend.searchyourtour.com/api/customer/reservations/${e}`,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest"}}),s=await a.json();s.status&&(Ye.value=s.data||[])}catch(a){}}async function ua(){try{De.value="";const a=await fetch("https://backend.searchyourtour.com/api/login",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({email:Be.value,password:Fe.value})}),s=await a.json();if(s.status){He.value=!0,De.value="",localStorage.setItem("user",JSON.stringify(s.data)),localStorage.setItem("isLoggedIn","true");try{await na(s.data.id),await ca(s.data.id)}catch(e){}Be.value="",Fe.value=""}else De.value=We("myPass.login.error")}catch(e){De.value=We("myPass.login.generalError")}}function da(){He.value=!1,localStorage.removeItem("user"),localStorage.removeItem("isLoggedIn")}async function pa(){try{const e=localStorage.getItem("user");if(!e)return void alert(We("myPass.messages.userNotFound"));const a=JSON.parse(e),s=await fetch(`https://backend.searchyourtour.com/api/customer/profile/update/${a.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({fullname:`${Ke.value.firstName} ${Ke.value.lastName}`.trim(),email:Ke.value.email,phone:Ke.value.phone,address:Ke.value.address,city:Ke.value.city,country:Ke.value.country,zip_code:Ke.value.zip_code})}),t=await s.json();t.status?alert(We("myPass.messages.profileUpdated")):alert(We("myPass.messages.profileUpdateFailed")+(t.message||We("myPass.messages.unknownError")))}catch(e){alert(We("myPass.messages.generalError"))}}async function ma(){try{if(aa.value="",sa.value=!1,Ze.value.length<6)return aa.value=We("myPass.password.validation.tooShort"),void(sa.value=!1);if(Ze.value!==ea.value)return aa.value=We("myPass.password.validation.noMatch"),void(sa.value=!1);const e=localStorage.getItem("user");if(!e)return aa.value=We("myPass.messages.userNotFound"),void(sa.value=!1);const a=JSON.parse(e),s=await fetch(`https://backend.searchyourtour.com/api/customer/change-password/${a.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({current_password:Qe.value,new_password:Ze.value,new_password_confirmation:ea.value})}),t=await s.json();t.status?(aa.value=We("myPass.password.success"),sa.value=!0,Qe.value="",Ze.value="",ea.value=""):(aa.value=t.message||We("myPass.password.error"),sa.value=!1)}catch(e){aa.value=We("myPass.password.generalError"),sa.value=!1}}function va(e){if(!e)return"N/A";return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}function ya(e){const a=[];return e.adult>0&&a.push(`${We("myPass.reservations.adults")}: ${e.adult}`),e.child>0&&a.push(`${We("myPass.reservations.children")}: ${e.child}`),e.infant>0&&a.push(`${We("myPass.reservations.infants")}: ${e.infant}`),e.buggy>0&&a.push(`${We("myPass.reservations.buggy")}: ${e.buggy}`),a.length>0?a.join(", "):We("myPass.reservations.noAttendees")}function ha(e){if(!e)return!0;return["pending","waiting","approved","paid","Pending","Waiting","Approved","Paid"].includes(e)}function fa(){const e=Ke.value.firstName||"",a=Ke.value.lastName||"";return(e.charAt(0)+a.charAt(0)).toUpperCase()||"U"}async function Pa(){try{oa.value=!0,ra.value="",ia.value=!1;const e=await fetch("https://backend.searchyourtour.com/api/customer/password/email",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({email:la.value})}),a=await e.json();a.status?(ia.value=!0,ra.value=a.message||We("myPass.resetPassword.success"),la.value="",setTimeout(()=>{ta.value=!1,ra.value=""},3e3)):(ia.value=!1,ra.value=a.message||We("myPass.resetPassword.error"))}catch(e){ia.value=!1,ra.value=We("myPass.messages.generalError")}finally{oa.value=!1}}return a(async()=>{const e=localStorage.getItem("isLoggedIn"),a=localStorage.getItem("user");if("true"===e&&a){He.value=!0;try{const e=JSON.parse(a);await na(e.id),await ca(e.id)}catch(s){}}}),(e,a)=>(m(),s("div",h,[He.value?(m(),s("div",U,[t("aside",q,[t("div",_,[t("div",I,[t("span",null,o(fa()),1)]),t("div",V,[t("h3",null,o(((Ke.value.firstName||"")+" "+(Ke.value.lastName||"")).trim()||"User"),1),t("p",null,o(e.$t("myPass.dashboard.account")),1)])]),t("nav",T,[t("div",{class:c(["nav-item",{active:"reservations"===Ge.value}]),onClick:a[8]||(a[8]=e=>Ge.value="reservations")},[a[23]||(a[23]=t("i",{class:"nav-icon"},"📋",-1)),t("span",null,o(e.$t("myPass.dashboard.myReservations")),1)],2),t("div",{class:c(["nav-item",{active:"info"===Ge.value}]),onClick:a[9]||(a[9]=e=>Ge.value="info")},[a[24]||(a[24]=t("i",{class:"nav-icon"},"👤",-1)),t("span",null,o(e.$t("myPass.dashboard.profile")),1)],2),t("div",{class:c(["nav-item",{active:"password"===Ge.value}]),onClick:a[10]||(a[10]=e=>Ge.value="password")},[a[25]||(a[25]=t("i",{class:"nav-icon"},"🔒",-1)),t("span",null,o(e.$t("myPass.dashboard.changePassword")),1)],2)]),t("button",{class:"logout-btn",onClick:da},[a[26]||(a[26]=t("i",{class:"logout-icon"},"🚪",-1)),u(" "+o(e.$t("myPass.dashboard.logout")),1)])]),t("main",A,["reservations"===Ge.value?(m(),s("section",R,[t("div",X,[t("h2",null,o(e.$t("myPass.reservations.title")),1),t("p",x,o(e.$t("myPass.reservations.subtitle")),1)]),t("div",L,[(m(!0),s(d,null,p(Ye.value,l=>{return m(),s("div",{class:"reservation-card",key:l.id},[t("div",O,[t("h3",null,o(l.tourName),1),t("span",{class:c(["status-badge",l.payment_status])},o((r=l.payment_status,r.charAt(0).toUpperCase()+r.slice(1))),3)]),t("div",z,[t("div",J,[t("div",E,[a[27]||(a[27]=t("i",{class:"detail-icon"},"📅",-1)),t("span",M,o(e.$t("myPass.reservations.date")),1),t("span",W,o(va(l.tour_date)),1)]),t("div",H,[a[28]||(a[28]=t("i",{class:"detail-icon"},"⏰",-1)),t("span",B,o(e.$t("myPass.reservations.time")),1),t("span",F,o(l.tour_time||e.$t("myPass.reservations.tbd")),1)])]),t("div",D,[t("div",G,[a[29]||(a[29]=t("i",{class:"detail-icon"},"💰",-1)),t("span",Y,o(e.$t("myPass.reservations.total")),1),t("span",K,o(l.total)+" "+o(l.totalCurrency),1)]),t("div",Q,[a[30]||(a[30]=t("i",{class:"detail-icon"},"👥",-1)),t("span",Z,o(e.$t("myPass.reservations.attendees")),1),t("span",ee,o(ya(l)),1)])])]),t("div",ae,[t("button",{class:"btn btn-edit",onClick:e=>function(e){alert(We("myPass.messages.reservationEdit")+e.id)}(l)},[a[31]||(a[31]=t("i",{class:"btn-icon"},"✏️",-1)),u(" "+o(e.$t("myPass.reservations.edit")),1)],8,se),t("button",{class:"btn btn-cancel",onClick:e=>function(e){confirm(We("myPass.messages.confirmCancel"))&&alert(We("myPass.messages.reservationCancel")+e.id)}(l),disabled:!ha(l.payment_status)},[a[32]||(a[32]=t("i",{class:"btn-icon"},"❌",-1)),u(" "+o(e.$t("myPass.reservations.cancel")),1)],8,te)])]);var r}),128)),0===Ye.value.length?(m(),s("div",le,[a[33]||(a[33]=t("div",{class:"empty-icon"},"📋",-1)),t("h3",null,o(e.$t("myPass.reservations.emptyState.title")),1),t("p",null,o(e.$t("myPass.reservations.emptyState.description")),1),t("button",{class:"btn btn-primary",onClick:a[11]||(a[11]=a=>e.$router.push("/tours"))},o(e.$t("myPass.reservations.emptyState.browseTours")),1)])):l("",!0)])])):l("",!0),"info"===Ge.value?(m(),s("section",oe,[t("div",re,[t("h2",null,o(e.$t("myPass.profile.title")),1),t("p",ie,o(e.$t("myPass.profile.subtitle")),1)]),t("form",{onSubmit:r(pa,["prevent"]),class:"profile-form"},[t("div",ne,[t("h3",null,o(e.$t("myPass.profile.personalInfo")),1),t("div",ce,[t("div",ue,[t("label",null,o(e.$t("myPass.profile.firstName")),1),i(t("input",{"onUpdate:modelValue":a[12]||(a[12]=e=>Ke.value.firstName=e),type:"text",placeholder:e.$t("myPass.profile.firstNamePlaceholder"),required:""},null,8,de),[[n,Ke.value.firstName]])]),t("div",pe,[t("label",null,o(e.$t("myPass.profile.lastName")),1),i(t("input",{"onUpdate:modelValue":a[13]||(a[13]=e=>Ke.value.lastName=e),type:"text",placeholder:e.$t("myPass.profile.lastNamePlaceholder"),required:""},null,8,me),[[n,Ke.value.lastName]])])])]),t("div",ve,[t("h3",null,o(e.$t("myPass.profile.contactInfo")),1),t("div",ye,[t("label",null,o(e.$t("myPass.profile.emailAddress")),1),i(t("input",{"onUpdate:modelValue":a[14]||(a[14]=e=>Ke.value.email=e),type:"email",placeholder:e.$t("myPass.profile.emailPlaceholder"),required:"",disabled:""},null,8,he),[[n,Ke.value.email]]),t("small",fe,o(e.$t("myPass.profile.emailNote")),1)]),t("div",Pe,[t("label",null,o(e.$t("myPass.profile.mobilePhone")),1),i(t("input",{"onUpdate:modelValue":a[15]||(a[15]=e=>Ke.value.phone=e),type:"tel",placeholder:e.$t("myPass.profile.phonePlaceholder")},null,8,ge),[[n,Ke.value.phone]])])]),t("div",be,[t("h3",null,o(e.$t("myPass.profile.addressInfo")),1),t("div",we,[t("label",null,o(e.$t("myPass.profile.address")),1),i(t("input",{"onUpdate:modelValue":a[16]||(a[16]=e=>Ke.value.address=e),type:"text",placeholder:e.$t("myPass.profile.addressPlaceholder")},null,8,$e),[[n,Ke.value.address]])]),t("div",ke,[t("div",Ne,[t("label",null,o(e.$t("myPass.profile.city")),1),i(t("input",{"onUpdate:modelValue":a[17]||(a[17]=e=>Ke.value.city=e),type:"text",placeholder:e.$t("myPass.profile.cityPlaceholder")},null,8,Se),[[n,Ke.value.city]])]),t("div",Ce,[t("label",null,o(e.$t("myPass.profile.country")),1),i(t("input",{"onUpdate:modelValue":a[18]||(a[18]=e=>Ke.value.country=e),type:"text",placeholder:e.$t("myPass.profile.countryPlaceholder")},null,8,je),[[n,Ke.value.country]])])]),t("div",Ue,[t("label",null,o(e.$t("myPass.profile.zipCode")),1),i(t("input",{"onUpdate:modelValue":a[19]||(a[19]=e=>Ke.value.zip_code=e),type:"text",placeholder:e.$t("myPass.profile.zipPlaceholder")},null,8,qe),[[n,Ke.value.zip_code]])])]),t("div",_e,[t("button",Ie,[a[34]||(a[34]=t("i",{class:"btn-icon"},"💾",-1)),u(" "+o(e.$t("myPass.profile.saveChanges")),1)])])],32)])):l("",!0),"password"===Ge.value?(m(),s("section",Ve,[t("div",Te,[t("h2",null,o(e.$t("myPass.password.title")),1),t("p",Ae,o(e.$t("myPass.password.subtitle")),1)]),t("form",{onSubmit:r(ma,["prevent"]),class:"password-form"},[t("div",Re,[t("label",null,o(e.$t("myPass.password.currentPassword")),1),i(t("input",{"onUpdate:modelValue":a[20]||(a[20]=e=>Qe.value=e),type:"password",placeholder:e.$t("myPass.password.currentPasswordPlaceholder"),required:""},null,8,Xe),[[n,Qe.value]])]),t("div",xe,[t("label",null,o(e.$t("myPass.password.newPassword")),1),i(t("input",{"onUpdate:modelValue":a[21]||(a[21]=e=>Ze.value=e),type:"password",placeholder:e.$t("myPass.password.newPasswordPlaceholder"),required:""},null,8,Le),[[n,Ze.value]]),t("small",Oe,o(e.$t("myPass.password.passwordNote")),1)]),t("div",ze,[t("label",null,o(e.$t("myPass.password.confirmPassword")),1),i(t("input",{"onUpdate:modelValue":a[22]||(a[22]=e=>ea.value=e),type:"password",placeholder:e.$t("myPass.password.confirmPasswordPlaceholder"),required:""},null,8,Je),[[n,ea.value]])]),t("div",Ee,[t("button",Me,[a[35]||(a[35]=t("i",{class:"btn-icon"},"🔒",-1)),u(" "+o(e.$t("myPass.password.changePasswordBtn")),1)])]),aa.value?(m(),s("div",{key:0,class:c(["message",sa.value?"success":"error"])},[t("i",{class:c(sa.value?"✅":"❌")},null,2),u(" "+o(aa.value),1)],2)):l("",!0)],32)])):l("",!0)])])):(m(),s("div",f,[t("div",P,[t("h2",null,o(e.$t("myPass.login.title")),1),t("form",{onSubmit:r(ua,["prevent"])},[i(t("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>Be.value=e),type:"email",placeholder:e.$t("myPass.login.email"),required:""},null,8,g),[[n,Be.value]]),i(t("input",{"onUpdate:modelValue":a[1]||(a[1]=e=>Fe.value=e),type:"password",placeholder:e.$t("myPass.login.password"),required:""},null,8,b),[[n,Fe.value]]),t("div",w,[t("a",{href:"#",onClick:a[2]||(a[2]=r(e=>ta.value=!0,["prevent"]))},o(e.$t("myPass.login.forgotPassword")),1)]),t("button",$,o(e.$t("myPass.login.loginBtn")),1),t("button",{class:"btn btn-secondary signup-btn",type:"button",style:{"margin-top":"10px"},onClick:a[3]||(a[3]=a=>e.$router.push("/signup"))},o(e.$t("myPass.login.signupBtn")),1)],32),De.value?(m(),s("div",k,o(De.value),1)):l("",!0)]),ta.value?(m(),s("div",{key:0,class:"modal-overlay",onClick:a[7]||(a[7]=e=>ta.value=!1)},[t("div",{class:"modal-content",onClick:a[6]||(a[6]=r(()=>{},["stop"]))},[t("div",N,[t("h3",null,o(e.$t("myPass.resetPassword.title")),1),t("button",{class:"close-btn",onClick:a[4]||(a[4]=e=>ta.value=!1)},"×")]),t("form",{onSubmit:r(Pa,["prevent"]),class:"reset-form"},[t("div",S,[t("label",null,o(e.$t("myPass.resetPassword.email")),1),i(t("input",{"onUpdate:modelValue":a[5]||(a[5]=e=>la.value=e),type:"email",placeholder:e.$t("myPass.resetPassword.emailPlaceholder"),required:""},null,8,C),[[n,la.value]])]),t("button",{class:"btn btn-primary",type:"submit",disabled:oa.value},o(oa.value?e.$t("myPass.resetPassword.sending"):e.$t("myPass.resetPassword.sendBtn")),9,j),ra.value?(m(),s("div",{key:0,class:c(["message",ia.value?"success":"error"])},o(ra.value),3)):l("",!0)],32)])])):l("",!0)]))]))}},[["__scopeId","data-v-7ef8dff2"]]);export{We as default};
