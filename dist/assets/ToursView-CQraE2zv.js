import{r as e,A as a,o as t,w as l,D as n,c as s,a as r,b as o,k as u,X as i,F as c,l as d,t as v,f as p,h,I as m,e as g,g as f,i as y}from"./vendor-D8r79KCq.js";import{_ as k}from"./index-D1Cofecw.js";import"./swiper-WOzPqNul.js";const w={class:"tours"},b={class:"tours-section"},_={class:"container"},x={class:"tours-header"},$={class:"filters"},I=["value"],D={key:0,class:"loading-state"},L={key:1,class:"error-state"},C={key:2,class:"tours-grid"},E={class:"tour-image"},T=["src","alt"],U={class:"tour-overlay"},A=["onClick"],H={key:0,class:"sell-out-badge"},j={class:"tour-content"},S={class:"tour-meta"},F={class:"destination"},M={class:"duration"},V={class:"tour-footer"},N={class:"tour-price"},P={key:3,class:"no-results"},R=k({__name:"ToursView",setup(k,{expose:R}){const B=e(""),q=e(""),z=e([]),G=e(!1),X=e(null),Y=e(null),J=e(null),K=e("en"),O=a(()=>{const e=localStorage.getItem("selectedCurrency")||"EUR";return Z(e)}),Q=async()=>{G.value=!0,X.value=null;try{const e=`https://backend.searchyourtour.com/api/tours?token=ad5257a5-efdd-4314-9e5e-b56aabe321f1&language_id=${W(K.value)}&currency_id=${O.value}&limit=100&IpAdrress=78.177.166.135`,a=await fetch(e);if(!a.ok)throw new Error("Failed to fetch tours");const t=await a.json();z.value=t||[]}catch(e){X.value="Failed to load tours. Please try again later."}finally{G.value=!1}},W=e=>({tr:2,de:6,en:1,ar:3,es:4,fr:5,it:7,pt:8,zh:10,ja:11,ru:9}[e]||1),Z=e=>({EUR:4,USD:5,GBP:6,TRY:7}[e]||4),ee=e=>{var a,t;return(null==(t=null==(a=e.content)?void 0:a[0])?void 0:t.name)||"Unnamed Tour"},ae=e=>{var a,t;const l=null==(t=null==(a=e.content)?void 0:a[0])?void 0:t.meta_content;if(!l)return"No description available";const n=document.createElement("div");n.innerHTML=l;const s=n.textContent||n.innerText||"";return s.length>150?s.substring(0,150)+"...":s},te=e=>{var a,t;return(null==(t=null==(a=e.files)?void 0:a[0])?void 0:t.url)||"https://via.placeholder.com/400x250?text=No+Image"},le=e=>{var a;return(null==(a=e.destination)?void 0:a.name)||"Unknown Destination"},ne=e=>{var a;const t=null==(a=e.tour_price)?void 0:a[0];if(!t)return"Price on request";return`${t.currency_icon||"$"}${t.price}`},se=e=>{const a=e.tour_duraction,t=e.tour_duraction_type||"hour";return a?"hour"===t?`${a} ${1===a?"Hour":"Hours"}`:"day"===t?`${a} ${1===a?"Day":"Days"}`:`${a} ${t}s`:"Duration not specified"},re=()=>{if(0===z.value.length)return;const e=Math.floor(Math.random()*z.value.length);J.value=z.value[e].id},oe=a(()=>{const e=z.value.map(e=>{var a;return null==(a=e.destination)?void 0:a.name}).filter(Boolean);return[...new Set(e)]}),ue=a(()=>z.value.filter(e=>{var a;const t=!B.value||(null==(a=e.destination)?void 0:a.name)===B.value,l=!q.value||(()=>{const a=e.tour_duraction;switch(q.value){case"1-3":return a>=1&&a<=3;case"4-6":return a>=4&&a<=6;case"7+":return a>=7;default:return!0}})();return t&&l})),ie=()=>{B.value="",q.value=""};R({updateLanguage:e=>{K.value=e,Q()}});const ce=e=>{e.detail&&e.detail.currency&&Q()};return t(()=>{window.addEventListener("currency-changed",ce);const e=localStorage.getItem("selectedLanguage")||"en";K.value=e,Q(),l(z,e=>{e.length>0&&!Y.value&&(()=>{re();const e=36e5*Math.random()+108e5;Y.value=setInterval(()=>{re()},e)})()},{immediate:!0})}),n(()=>{window.removeEventListener("currency-changed",ce),Y.value&&(clearInterval(Y.value),Y.value=null)}),l(()=>localStorage.getItem("selectedLanguage"),e=>{e&&e!==K.value&&(K.value=e,Q())}),(e,a)=>{const t=p("router-link");return h(),s("div",w,[a[10]||(a[10]=r("section",{class:"hero-section"},[r("div",{class:"container"},[r("div",{class:"hero-content"},[r("h2",null,"Explore the city's rich history and culture with our expert guides. Visit iconic landmarks with skip-the-line access and insider knowledge.")])])],-1)),r("section",b,[r("div",_,[r("div",x,[a[4]||(a[4]=r("h2",null,"Available Tours",-1)),r("div",$,[u(r("select",{"onUpdate:modelValue":a[0]||(a[0]=e=>B.value=e),class:"filter-select"},[a[2]||(a[2]=r("option",{value:""},"All Destinations",-1)),(h(!0),s(c,null,d(oe.value,e=>(h(),s("option",{key:e,value:e},v(e),9,I))),128))],512),[[i,B.value]]),u(r("select",{"onUpdate:modelValue":a[1]||(a[1]=e=>q.value=e),class:"filter-select"},a[3]||(a[3]=[r("option",{value:""},"All Durations",-1),r("option",{value:"1-3"},"1-3 Hours",-1),r("option",{value:"4-6"},"4-6 Hours",-1),r("option",{value:"7+"},"7+ Hours",-1)]),512),[[i,q.value]])])]),G.value?(h(),s("div",D,a[5]||(a[5]=[r("div",{class:"loading-spinner"},null,-1),r("p",null,"Loading tours...",-1)]))):X.value?(h(),s("div",L,[r("p",null,v(X.value),1),r("button",{onClick:Q,class:"btn btn-primary"},"Try Again")])):(h(),s("div",C,[(h(!0),s(c,null,d(ue.value,e=>(h(),m(t,{key:e.id,to:`/tour/${e.id}`,class:"tour-card",style:{"text-decoration":"none",color:"inherit",display:"flex","flex-direction":"column",height:"100%"}},{default:g(()=>{return[r("div",E,[r("img",{src:te(e),alt:ee(e)},null,8,T),r("div",U,[r("button",{onClick:f(a=>{e.id},["stop"]),class:"wishlist-btn"},a[6]||(a[6]=[r("i",{class:"fas fa-heart"},null,-1)]),8,A)]),(t=e.id,J.value===t?(h(),s("div",H," Likely to sell out ")):o("",!0))]),r("div",j,[r("h3",null,v(ee(e)),1),r("p",null,v(ae(e)),1),r("div",S,[r("span",F,[a[7]||(a[7]=r("i",{class:"fas fa-map-marker-alt"},null,-1)),y(" "+v(le(e)),1)]),r("span",M,[a[8]||(a[8]=r("i",{class:"fas fa-clock"},null,-1)),y(" "+v(se(e)),1)])]),r("div",V,[r("div",N,v(ne(e)),1)])])];var t}),_:2},1032,["to"]))),128))])),G.value||X.value||0!==ue.value.length?o("",!0):(h(),s("div",P,[a[9]||(a[9]=r("p",null,"No tours found matching your criteria.",-1)),r("button",{onClick:ie,class:"btn btn-primary"},"Clear Filters")]))])])])}}},[["__scopeId","data-v-c1bc2a12"]]);export{R as default};
