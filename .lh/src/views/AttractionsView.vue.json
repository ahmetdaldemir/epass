{
    "sourceFile": "src/views/AttractionsView.vue",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 3,
            "patches": [
                {
                    "date": 1754384960343,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1754385005470,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -4,8 +4,10 @@\n       <div class=\"container\">\r\n         <h1>Istanbul Attractions & Tours - Discover Top Cultural Sites</h1>\r\n         <h2>Explore Hagia Sophia, Topkapi Palace, Basilica Cistern & More</h2>\r\n         <p>Discover the most popular attractions and guided tours included in your Istanbul Tourist Pass. Visit iconic landmarks and hidden gems with expert guides.</p>\r\n+        <p style=\"color: yellow; font-weight: bold; font-size: 24px;\">DEBUG: AttractionsView is loading!</p>\r\n+        <p style=\"color: red; font-size: 24px; font-weight: bold;\">ATTRACTIONS PAGE IS WORKING!</p>\r\n       </div>\r\n     </section>\r\n \r\n     <section class=\"attractions-list\">\r\n"
                },
                {
                    "date": 1754385112317,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -4,10 +4,9 @@\n       <div class=\"container\">\r\n         <h1>Istanbul Attractions & Tours - Discover Top Cultural Sites</h1>\r\n         <h2>Explore Hagia Sophia, Topkapi Palace, Basilica Cistern & More</h2>\r\n         <p>Discover the most popular attractions and guided tours included in your Istanbul Tourist Pass. Visit iconic landmarks and hidden gems with expert guides.</p>\r\n-        <p style=\"color: yellow; font-weight: bold; font-size: 24px;\">DEBUG: AttractionsView is loading!</p>\r\n-        <p style=\"color: red; font-size: 24px; font-weight: bold;\">ATTRACTIONS PAGE IS WORKING!</p>\r\n+\r\n       </div>\r\n     </section>\r\n \r\n     <section class=\"attractions-list\">\r\n@@ -65,9 +64,9 @@\n   </div>\r\n </template>\r\n \r\n <script setup>\r\n-import { ref, onMounted, watch } from 'vue'\r\n+import { ref, onMounted, watch, computed, onBeforeUnmount } from 'vue'\r\n \r\n const attractions = ref([])\r\n const loading = ref(false)\r\n const error = ref(null)\r\n"
                },
                {
                    "date": 1754385174809,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -4,9 +4,8 @@\n       <div class=\"container\">\r\n         <h1>Istanbul Attractions & Tours - Discover Top Cultural Sites</h1>\r\n         <h2>Explore Hagia Sophia, Topkapi Palace, Basilica Cistern & More</h2>\r\n         <p>Discover the most popular attractions and guided tours included in your Istanbul Tourist Pass. Visit iconic landmarks and hidden gems with expert guides.</p>\r\n-\r\n       </div>\r\n     </section>\r\n \r\n     <section class=\"attractions-list\">\r\n@@ -64,9 +63,9 @@\n   </div>\r\n </template>\r\n \r\n <script setup>\r\n-import { ref, onMounted, watch, computed, onBeforeUnmount } from 'vue'\r\n+import { ref, onMounted, watch, computed ,onBeforeUnmount } from 'vue'\r\n \r\n const attractions = ref([])\r\n const loading = ref(false)\r\n const error = ref(null)\r\n"
                }
            ],
            "date": 1754384960343,
            "name": "Commit-0",
            "content": "<template>\r\n  <div class=\"attractions\">\r\n    <section class=\"hero-section\">\r\n      <div class=\"container\">\r\n        <h1>Istanbul Attractions & Tours - Discover Top Cultural Sites</h1>\r\n        <h2>Explore Hagia Sophia, Topkapi Palace, Basilica Cistern & More</h2>\r\n        <p>Discover the most popular attractions and guided tours included in your Istanbul Tourist Pass. Visit iconic landmarks and hidden gems with expert guides.</p>\r\n      </div>\r\n    </section>\r\n\r\n    <section class=\"attractions-list\">\r\n      <div class=\"container\">\r\n        <!-- Loading State -->\r\n        <div v-if=\"loading\" class=\"loading-state\">\r\n          <div class=\"loading-spinner\"></div>\r\n          <p>Loading Istanbul attractions...</p>\r\n        </div>\r\n\r\n        <!-- Error State -->\r\n        <div v-else-if=\"error\" class=\"error-state\">\r\n          <p>{{ error }}</p>\r\n          <button @click=\"fetchAttractions\" class=\"btn btn-primary\">Try Again</button>\r\n        </div>\r\n\r\n        <!-- Attractions Grid -->\r\n        <div v-else class=\"attractions-grid\">\r\n          <router-link\r\n            v-for=\"attraction in attractions\"\r\n            :key=\"attraction.id\"\r\n            :to=\"`/tour/${attraction.id}`\"\r\n            class=\"attraction-card\"\r\n            style=\"text-decoration: none; color: inherit; display: block; height: 100%;\"\r\n          >\r\n            <div class=\"attraction-image\">\r\n              <img :src=\"getAttractionImage(attraction)\" :alt=\"getAttractionName(attraction)\">\r\n            </div>\r\n            <div class=\"attraction-content\">\r\n              <h3>{{ getAttractionName(attraction) }}</h3>\r\n              <p>{{ getAttractionDescription(attraction) }}</p>\r\n              <div class=\"attraction-meta\">\r\n                <span class=\"price\">{{ getAttractionPrice(attraction) }}</span>\r\n                <span class=\"duration\">\r\n                  <i class=\"fas fa-clock\"></i>\r\n                  {{ getAttractionDuration(attraction) }}\r\n                </span>\r\n              </div>\r\n              <div class=\"attraction-actions\">\r\n                <router-link @click.stop :to=\"`/tour/${attraction.id}`\" class=\"btn btn-primary\">View</router-link>\r\n                <button @click.stop=\"addToWishlist(attraction.id)\" class=\"btn btn-secondary\">\r\n                  <i class=\"fas fa-heart\"></i>\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </router-link>\r\n        </div>\r\n\r\n        <!-- No Results -->\r\n        <div v-if=\"!loading && !error && attractions.length === 0\" class=\"no-results\">\r\n          <p>No Istanbul attractions found at the moment.</p>\r\n        </div>\r\n      </div>\r\n    </section>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted, watch } from 'vue'\r\n\r\nconst attractions = ref([])\r\nconst loading = ref(false)\r\nconst error = ref(null)\r\nconst currentLanguage = ref('en')\r\nconst currentCurrency = computed(() => {\r\n  const savedCurrency = localStorage.getItem('selectedCurrency') || 'EUR'\r\n  return getCurrencyId(savedCurrency)\r\n})\r\n\r\n// Fetch Istanbul attractions from API with language and currency parameters\r\nconst fetchAttractions = async () => {\r\n  loading.value = true\r\n  error.value = null\r\n  \r\n  try {\r\n    const url = `https://searchyourtour.com/api/tours?token=ad5257a5-efdd-4314-9e5e-b56aabe321f1&language_id=${getLanguageId(currentLanguage.value)}&currency_id=${currentCurrency.value}&limit=200&IpAdrress=78.177.166.135`\r\n    \r\n    const response = await fetch(url)\r\n    if (!response.ok) {\r\n      throw new Error('Failed to fetch attractions')\r\n    }\r\n    \r\n    const data = await response.json()\r\n    \r\n    // Filter for Istanbul tours (destination_id: 404) and active tours with content\r\n    const istanbulTours = (data || []).filter(tour => {\r\n      return tour.destination?.id === 404 && \r\n             tour.is_active === true\r\n    })\r\n    console.log(istanbulTours)\r\n    attractions.value = istanbulTours\r\n  } catch (err) {\r\n    error.value = 'Failed to load attractions. Please try again later.'\r\n    console.error('Error fetching attractions:', err)\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\n// Helper function to get language ID from language code\r\nconst getLanguageId = (langCode) => {\r\n  const languageMap = {\r\n    'tr': 2,    // Türkçe\r\n    'de': 6,    // Deutsch\r\n    'en': 1,    // English\r\n    'ar': 3,    // العربية\r\n    'es': 4,    // Español\r\n    'fr': 5,    // Français\r\n    'it': 7,    // Italiano\r\n    'pt': 8,    // Português\r\n    'zh': 10,   // 中文\r\n    'ja': 11,   // 日本語\r\n    'ru': 9     // Русский\r\n  }\r\n  return languageMap[langCode] || 1\r\n}\r\n\r\n// Helper function to get currency ID from currency code\r\nconst getCurrencyId = (currencyCode) => {\r\n  const currencyMap = {\r\n    'EUR': 4,\r\n    'USD': 5,\r\n    'GBP': 6,\r\n    'TRY': 7\r\n  }\r\n  return currencyMap[currencyCode] || 4\r\n}\r\n\r\n// Helper functions to extract data from API response\r\nconst getAttractionName = (attraction) => {\r\n  return attraction.content?.[0]?.name || 'Unnamed Attraction'\r\n}\r\n\r\nconst getAttractionDescription = (attraction) => {\r\n  const metaContent = attraction.content?.[0]?.meta_content\r\n  if (!metaContent) return 'No description available'\r\n  \r\n  // Remove HTML tags and extract plain text\r\n  const tempDiv = document.createElement('div')\r\n  tempDiv.innerHTML = metaContent\r\n  const text = tempDiv.textContent || tempDiv.innerText || ''\r\n  return text.length > 120 ? text.substring(0, 120) + '...' : text\r\n}\r\n\r\nconst getAttractionImage = (attraction) => {\r\n  return attraction.files?.[0]?.url || 'https://via.placeholder.com/300x200?text=Istanbul+Attraction'\r\n}\r\n\r\nconst getAttractionPrice = (attraction) => {\r\n  const price = attraction.tour_price?.[0]\r\n  if (!price) return 'CALL'\r\n  \r\n  const currency = price.currency_icon || '$'\r\n  return `${currency}${price.price}`\r\n}\r\n\r\nconst getAttractionDuration = (attraction) => {\r\n  const duration = attraction.tour_duraction\r\n  const type = attraction.tour_duraction_type\r\n  \r\n  if (!duration) return 'Duration not specified'\r\n  \r\n  if (type === 'hour') {\r\n    return `${duration} ${duration === 1 ? 'Hr' : 'Hr'}`\r\n  } else if (type === 'day') {\r\n    return `${duration} ${duration === 1 ? 'Day' : 'Day'}`\r\n  } else if (type === 'week') {\r\n    return `${duration} ${duration === 1 ? 'Week' : 'Week'}`\r\n  } else if (type === 'month') {\r\n    return `${duration} ${duration === 1 ? 'Month' : 'Month'}`\r\n  } else if (type === 'minutes' || type === 'minute' || type === 'min') {\r\n    return `${duration} Min`\r\n  }\r\n  \r\n  return `${duration} ${type}s`\r\n}\r\n\r\n// Methods\r\nconst addToWishlist = (attractionId) => {\r\n  console.log('Adding attraction to wishlist:', attractionId)\r\n  // Implement wishlist functionality\r\n}\r\n\r\n// Watch for language changes\r\nconst updateLanguage = (newLanguage) => {\r\n  currentLanguage.value = newLanguage\r\n  fetchAttractions() // Refetch attractions with new language\r\n}\r\n\r\n// Expose method for parent components\r\ndefineExpose({\r\n  updateLanguage\r\n})\r\n\r\n// Listen for currency change events\r\nconst handleCurrencyChange = (event) => {\r\n  if (event.detail && event.detail.currency) {\r\n    console.log('AttractionsView: Currency changed to:', event.detail.currency, 'ID:', event.detail.currencyId)\r\n    fetchAttractions() // Refetch attractions with new currency\r\n  }\r\n}\r\n\r\n// Lifecycle\r\nonMounted(() => {\r\n  // Add event listener for currency changes\r\n  window.addEventListener('currency-changed', handleCurrencyChange)\r\n  // Get language from localStorage or default to English\r\n  const savedLanguage = localStorage.getItem('selectedLanguage') || 'en'\r\n  currentLanguage.value = savedLanguage\r\n  \r\n  fetchAttractions()\r\n})\r\n\r\nonBeforeUnmount(() => {\r\n  // Remove event listener\r\n  window.removeEventListener('currency-changed', handleCurrencyChange)\r\n})\r\n\r\n// Watch for language changes in localStorage\r\nwatch(() => localStorage.getItem('selectedLanguage'), (newLanguage) => {\r\n  if (newLanguage && newLanguage !== currentLanguage.value) {\r\n    currentLanguage.value = newLanguage\r\n    fetchAttractions()\r\n  }\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n.attractions {\r\n  min-height: 100vh;\r\n}\r\n\r\n.hero-section {\r\n  background: #FC6421;\r\n  color: white;\r\n  padding: 4rem 0;\r\n  text-align: center;\r\n}\r\n\r\n.hero-section h1 {\r\n  font-size: 3rem;\r\n  margin-bottom: 1rem;\r\n}\r\n\r\n.attractions-list {\r\n  padding: 4rem 0;\r\n}\r\n\r\n/* Loading State */\r\n.loading-state {\r\n  text-align: center;\r\n  padding: 4rem 0;\r\n}\r\n\r\n.loading-spinner {\r\n  width: 50px;\r\n  height: 50px;\r\n  border: 4px solid #f3f3f3;\r\n  border-top: 4px solid #fc6421;\r\n  border-radius: 50%;\r\n  animation: spin 1s linear infinite;\r\n  margin: 0 auto 1rem;\r\n}\r\n\r\n@keyframes spin {\r\n  0% { transform: rotate(0deg); }\r\n  100% { transform: rotate(360deg); }\r\n}\r\n\r\n/* Error State */\r\n.error-state {\r\n  text-align: center;\r\n  padding: 4rem 0;\r\n  color: #fc6421;\r\n}\r\n\r\n.error-state p {\r\n  margin-bottom: 1rem;\r\n  font-size: 1.1rem;\r\n}\r\n\r\n/* No Results */\r\n.no-results {\r\n  text-align: center;\r\n  padding: 4rem 0;\r\n  color: #666;\r\n}\r\n\r\n.attractions-grid {\r\n  display: grid;\r\n  grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));\r\n  gap: 2rem;\r\n}\r\n\r\n.attraction-card {\r\n  background: white;\r\n  border-radius: 12px;\r\n  overflow: hidden;\r\n  box-shadow: 0 4px 20px rgba(0,0,0,0.1);\r\n  transition: transform 0.3s ease, box-shadow 0.3s ease;\r\n}\r\n\r\n.attraction-card:hover {\r\n  transform: translateY(-8px);\r\n  box-shadow: 0 8px 30px rgba(0,0,0,0.15);\r\n}\r\n\r\n.attraction-image img {\r\n  width: 100%;\r\n  height: 220px;\r\n  object-fit: cover;\r\n}\r\n\r\n.attraction-content {\r\n  padding: 1.5rem;\r\n}\r\n\r\n.attraction-content h3 {\r\n  margin-bottom: 0.75rem;\r\n  color: #2c3e50;\r\n  font-size: 1.3rem;\r\n  font-weight: 600;\r\n}\r\n\r\n.attraction-content p {\r\n  color: #666;\r\n  line-height: 1.6;\r\n  margin-bottom: 1rem;\r\n}\r\n\r\n.attraction-meta {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 1.5rem;\r\n  padding: 0.75rem 0;\r\n  border-top: 1px solid #eee;\r\n  border-bottom: 1px solid #eee;\r\n}\r\n\r\n.price {\r\n  color: #fc6421;\r\n  font-weight: 600;\r\n  font-size: 1.1rem;\r\n}\r\n\r\n.duration {\r\n  color: #666;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.5rem;\r\n}\r\n\r\n.attraction-actions {\r\n  display: flex;\r\n  gap: 1rem;\r\n  align-items: center;\r\n}\r\n\r\n.btn {\r\n  padding: 0.75rem 1.5rem;\r\n  border: none;\r\n  border-radius: 6px;\r\n  font-weight: 600;\r\n  text-decoration: none;\r\n  display: inline-flex;\r\n  align-items: center;\r\n  gap: 0.5rem;\r\n  cursor: pointer;\r\n  transition: all 0.3s ease;\r\n}\r\n\r\n.btn-primary {\r\n  background: #fc6421;\r\n  color: white;\r\n  flex: 1;\r\n}\r\n\r\n.btn-primary:hover {\r\n  background: #c0392b;\r\n  transform: translateY(-2px);\r\n}\r\n\r\n.btn-secondary {\r\n  background: #f8f9fa;\r\n  color: #666;\r\n  padding: 0.75rem;\r\n  min-width: 44px;\r\n}\r\n\r\n.btn-secondary:hover {\r\n  background: #e9ecef;\r\n  color: #fc6421;\r\n}\r\n\r\n/* Responsive Design */\r\n@media (max-width: 768px) {\r\n  .hero-section h1 {\r\n    font-size: 2rem;\r\n  }\r\n  .attractions-grid {\r\n    grid-template-columns: 1fr;\r\n    gap: 1rem;\r\n    padding: 0 0.5rem;\r\n  }\r\n  .attraction-card {\r\n    width: auto;\r\n    max-width: 100%;\r\n    height: auto;\r\n    border-radius: 20px;\r\n    box-shadow: 0 4px 18px rgba(44,62,80,0.10);\r\n    margin: 0.5rem 0.1rem 1rem 0.1rem;\r\n    padding: 0.7rem 0.5rem 0.7rem 0.5rem;\r\n    background: #fff;\r\n    border: 1.5px solid #f2f2f2;\r\n    display: flex;\r\n    flex-direction: column;\r\n    min-width: 0;\r\n  }\r\n  .attraction-image img {\r\n    width: 100%;\r\n    height: 90px;\r\n    object-fit: cover;\r\n    border-radius: 16px 16px 0 0;\r\n    margin-bottom: 0.5rem;\r\n    box-shadow: 0 2px 8px rgba(44,62,80,0.07);\r\n  }\r\n  .attraction-content {\r\n    padding: 0.1rem 0.1rem 0 0.1rem;\r\n    flex: 1;\r\n    display: flex;\r\n    flex-direction: column;\r\n  }\r\n  .attraction-content h3 {\r\n    font-size: 1.09rem;\r\n    font-weight: 800;\r\n    margin-bottom: 0.18rem;\r\n    color: #222;\r\n    line-height: 1.18;\r\n    display: -webkit-box;\r\n    -webkit-line-clamp: 2;\r\n    -webkit-box-orient: vertical;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n    min-height: 2.2em;\r\n  }\r\n  .attraction-content p {\r\n    color: #8a8a8a;\r\n    font-size: 0.91rem;\r\n    line-height: 1.3;\r\n    margin-bottom: 0.35rem;\r\n    display: -webkit-box;\r\n    -webkit-line-clamp: 2;\r\n    -webkit-box-orient: vertical;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n    min-height: 2.3em;\r\n  }\r\n  .attraction-meta {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    margin-bottom: 0.4rem;\r\n    padding: 0.2rem 0;\r\n    border: none;\r\n    font-size: 0.97rem;\r\n    gap: 0.5rem;\r\n  }\r\n  .price {\r\n    color: #FC6421;\r\n    font-weight: 800;\r\n    font-size: 1.04rem;\r\n    letter-spacing: 0.01em;\r\n  }\r\n  .duration {\r\n    color: #666;\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 0.3rem;\r\n    font-size: 0.97rem;\r\n    font-weight: 500;\r\n  }\r\n  .attraction-actions {\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 0.5rem;\r\n    margin-top: auto;\r\n  }\r\n  .attraction-actions .btn-primary {\r\n    width: 100%;\r\n    font-size: 1.08rem;\r\n    border-radius: 12px;\r\n    margin-top: 0.2rem;\r\n    font-weight: 700;\r\n    letter-spacing: 0.01em;\r\n  }\r\n  .attraction-actions .btn-secondary {\r\n    width: 100%;\r\n    font-size: 1.08rem;\r\n    padding: 0.8rem 0;\r\n    border-radius: 12px;\r\n    margin-top: 0.2rem;\r\n    background: #f7f7f7;\r\n    color: #FC6421;\r\n    font-weight: 700;\r\n  }\r\n  /* Kart altı buton ve favori hizası */\r\n  .attraction-actions {\r\n    display: grid;\r\n    grid-template-columns: 3fr 1fr;\r\n    flex-direction: row;\r\n    gap: 0.7rem;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    margin-top: 0.7rem;\r\n  }\r\n  .attraction-actions .btn-primary, .attraction-actions .btn-secondary {\r\n    flex: 1 1 60%;\r\n    min-width: 0;\r\n  }\r\n}\r\n</style> "
        }
    ]
}